---
title: babel原理
date: 2021-07-13
sidebar: "auto"
categories:
  - plugins
tags:
  - babel
---

## babel 分析

**`babel`** 实际上类似一般的的语言编译器，作用就是输入输入代码，实际上跟很多人理解的不太一样，babel 并不是只能用于 ES6 编译成 ES5，只要你愿意，你完全可以把 ES5 编译成 ES6，或者使用自己创造的某种语法（例如 JSX，以及babel 插件就属于这类），你需要做的只是编写对应的插件。

**`babel`** 转换代码的过程主要为三步：

- 第一步：**解析** 使用 **`babylon`** 这个解析器，它会根据输入的 javascript 代码字符串根据 **`ESTree`** 规范生成 **`AST（抽象语法树）`** 。
- 第二步：**转换** 根据一定的规则转换、修改 AST。
- 第三步：**生成** 使用 **`babel-generator`** 将修改后的 **`AST`** 转换成普通代码

这就是 babel 工作的整个过程，就是纯粹的字符串输入输出而已，而 **`babel插件`** 或者 **`预置的stage-0,1,2,3，jsx`** 等，都是第二步转换的“规则”。

> **AST** 抽象语法树（Abstract Syntax Tree，AST） 它是源代码的一种映射，语言引擎根据 AST 就能知道代码的作用是什么。

**`babel`** 的插件系统基于 **`访问者模式`** 设计

## 总结

**`Babel`** 是 **`JavaScript 编译器`**：他能让开发者在开发过程中，直接使用各类方言（如 **`TS、Flow、JSX`**）或新的语法特性，而不需要考虑运行环境，因为 **`Babel`** 可以做到按需转换为低版本支持的代码；**`Babel`** 内部原理是将 **`JS`** 代码转换为 **`AST`，对 `AST`** 应用各种插件进行处理，最终输出编译后的 **`JS`** 代码。
